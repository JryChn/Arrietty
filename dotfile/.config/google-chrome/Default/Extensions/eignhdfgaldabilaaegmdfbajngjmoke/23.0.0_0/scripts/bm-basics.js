"use strict";var bmBasics=function(){var o,a,c,i,t,u,s,l,p,r,f,b;function d(n){u=[],s=[],Object.keys(l).forEach(function(e){var t=-1!==n.indexOf(e),r=l[e].hidden;(!r||t&&"unused"===r||p&&"permanent"!==r)&&(t?u:s).push(e)}),u=u.sort(function(e,t){return n.indexOf(e)<n.indexOf(t)?-1:1}),s=s.sort(function(e,t){return l[e].label<l[t].label?-1:1})}function n(){browserStorage.sync.setItem("bm_pref__portal__services",u),t.forEach(function(e){e(u,s)})}function _(e){r.then(function(){e(u,s)})}return{userServices:(t=[],u=[],s=[],p=!(l={}),r=new Promise(function(e){i=e}),f=["aboutme","gplus","youtube","ytstudio","mybusiness","adwordsexpress","photos","albumarchive","myaccount","contacts","save","poly","play"],b={webmastertools:"searchconsole",tiltbrushsketches:"poly",vrblocks:"poly",playmusic:"music",chromeapps:"browserapps",chromebookmarks:"browserbookmarks",chrometopsites:"browsertopsites",gmaillite:"gmail",calendarlite:"calendar",publicalerts:"covid19",keeplite:"keep","keep-pro":"keep",googlepay:"gpay",payments:"gpay",adwords:"ads",shortlists:"save",flightsandhotels:"travelpackages",flightshotels:"travelpackages",packages:"travelpackages",vacations:"travelpackages",express:"shopping",gplus:"currents"},{getLastUsed:function(){return r.then(function(){return 0<u.length?{serviceId:c}:{serviceId:"customize",sessionParameters:{welcome:!0}}})},get:_,set:function(e){d(e),n()},contains:function(e){return-1!==u.indexOf(e)},add:function(e){d(u.concat(e)),n()},remove:function(e){var t=[].concat(e);-1!==t.indexOf("covid19")&&browserStorage.sync.setItem("bm_pref__portal__publicalertcorona",!0),d(u.filter(function(e){return-1===t.indexOf(e)})),n()},onChange:function(e){t.push(e),_(e)},init:function(e){o=e.defaultServices||[],p=e.debug||!1,l=e.servicesDatabase||{};var t=!0,r=browserStorage.sync.get(["bm_pref__portal__services","bm_pref__portal__publicalertcorona"]).then(function(e){return e.bm_pref__portal__publicalertcorona&&(t=!1),e.bm_pref__portal__services}),n=[browserStorage.local.getItem("bm_pref__portal__lastused"),r,e.servicesDatabaseRequest,e.accountRequest],s=Promise.all(n).then(function(e){var t=b[e[0]]||e[0],r=e[1]||o;if(l=e[2],a=e[3],c=t||r[0],!p&&a.pageId)return-1===(u=Object.keys(l).filter(function(e){return l[e].brandAccount&&!l[e].hidden}).sort(function(e,t){return f.indexOf(e)-f.indexOf(t)})).indexOf(c)&&(c="aboutme"),null;if(!Array.isArray(r))return c=t||o[0],void d(o);var n=r.join(" ");Object.keys(b).forEach(function(e){var t=r.indexOf(e);-1!==t&&(r[t]=b[e])}),d(r),n!==u.join(" ")&&browserStorage.sync.setItem("bm_pref__portal__services",u)}).then(function(){var e=u.indexOf("covid19");t&&-1===e&&u.unshift("covid19")});i(s)}})}}();