"use strict";var cjgApis=function(){var h="undefined"!=typeof chrome&&chrome.runtime?chrome:"undefined"!=typeof browser&&browser,d=h.i18n.getMessage("@@extension_id"),f=atob,p=f("NDk0MDg2MDMwODUxLTkzdmplNzc4a29ncjlkbmZxMmhobGkyZTkxOHA0aGhhLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29t"),a=h.runtime.getURL("PATH/").replace("/PATH/",""),m="https://www.google.com",v="https://accounts.google.com",n="https://oauth2.googleapis.com";function o(r,e,t){var a;cjBasics.navigator.firefox&&-1!==r.indexOf("SAPISID=")&&(a=cjBasics.webRequest.addListener("onBeforeSendHeaders",function(e){a.removeListener();for(var t=e.requestHeaders,n=0;n<t.length;n++)if("cookie"===t[n].name.toLowerCase())return;return cjgApis.session.hasContentBlocking=!0,t.push({name:"Cookie",value:r}),{requestHeaders:t}},{urls:[e],types:[t?"sub_frame":"xmlhttprequest"]},["blocking","requestHeaders"]))}function w(e){return cjBasics.navigator.firefox?new Promise(function(n){h.cookies.getAll({url:e},function(e){var t=e.map(function(e){return e.name+"="+e.value}).join("; ");n(t)})}):Promise.resolve("")}var e,A,s,c,t=(e=cjBasics.webRequest.getTabId(),{create:function(a,o,i){e.then(function(e){var t=-1===e||-1!==window.location.search.indexOf("environment=popup"),n=Math.round(t?window.screenTop:(window.screen.height-600)/2),r=Math.round(t?window.screenLeft:(window.screen.width-600)/2);h.runtime.sendMessage({createNewPopup:{requestUrl:a,redirectUrl:o,method:i,topPosition:n,leftPosition:r}})})}}),r=(A="https://g.carlosjeurissen.com/gauth/",s={},c={},{getTokenInfo:j,requestPermissions:function(e,t){var n,r,a,o,i=(n=e,r=t,a=Array.isArray(r)?r:[],o=u(n),-1===a.indexOf(o)&&a.push(o),cjBasics.urlParams.attach(v+"/o/oauth2/v2/auth",{hl:cjBasics.lang.current,authuser:n.authuser||"0",client_id:p,login_hint:n.displayEmail,pageId:n.pageId||null,redirect_uri:A,response_type:"token",scope:a.join(" "),state:d+"---permissionrequest"})),s=m+"/cjg-auth/"+d+"*";cjgApis.popup.create(i,s,"auth")},revokePermissions:function(e){return I(e).then(y)},requireToken:I});function j(e){var t=cjBasics.urlParams.attach(n+"/tokeninfo",{access_token:e,prettyPrint:"false"});return cjBasics.ajax(t,{fetchAs:"json"})}function u(e){return e.pageId?"https://www.googleapis.com/auth/youtube.readonly":"https://www.googleapis.com/auth/userinfo.profile"}function i(e,t){var n={cjg_error:"not_authorized",cjg_missing_scopes:t};return Promise.reject(n)}function l(e,t,n){if(!t||!t.accessToken)return i(0,n);var r=[],a=t.grantedScopes||[];return n.forEach(function(e){-1===a.indexOf(e)&&r.push(e)}),0<r.length?i(0,r):t.accessToken}function g(e,r){return new Promise(function(i){var s=d+"---"+cjBasics.uniqueId.generate(),c=document.createElement("iframe");function t(e,t){var n=e.split("#")[1];if(n||!t){if("string"==typeof n){if(-1===n.indexOf("&"))try{n=f(n)}catch(e){n=""}var r,a,o=new URLSearchParams(n);if(o.get("state")!==s)return i(null);c.remove(),l&&l.removeListener(),u&&u.removeListener(),cjBasics.wrif.supported||h.runtime.onMessage.removeListener(g),o.get("error")?i(null):(a=j(r=o.get("access_token")).then(function(e){return e.aud!==p?null:{accessToken:r,grantedScopes:e.scope?e.scope.split(" "):[],expireTime:function(e){var t=Date.now(),n=Number(e.expires_in);if(n)return t+n;var r=Number(e.exp);return r?1e3*r:t}(e)}},function(){return null}),i(a))}}else i(null)}var u=cjBasics.webRequest.addListener("onBeforeRedirect",function(e){t(e.redirectUrl)},{types:["sub_frame"],urls:[m+"/cjg-auth/"+d+"*",v+"/*"+d+"*"]}),l=cjBasics.webRequest.catchAndStop([m+"/cjg-auth/"+d+"*"],function(e){t(e)});function g(e){e.cjgAuthUrl&&t(e.cjgAuthUrl,!0)}cjBasics.wrif.supported||h.runtime.onMessage.addListener(g),c.style.display="none";var n=cjBasics.urlParams.attach(v+"/o/oauth2/v2/auth",{authuser:e.authuser,client_id:p,include_granted_scopes:"true",pageId:e.pageId||null,prompt:"none",redirect_uri:A,response_type:"token",scope:r,state:s});c.src=n,cjBasics.navigator.firefox?w(n).then(function(e){o(e,n,!0),setTimeout(function(){document.body.appendChild(c)})}):document.body.appendChild(c)})}function I(t,n){var r=t.pageId+"-"+t.obfuscatedId;Array.isArray(n)&&0!==n.length||(n=[u(t)]);var e=s[r];if(e&&e.expireTime>Date.now()+1e4)return l(0,e,n);s[r]=null;var a,o,i=c[r];return i||(a=n[0],o=u(t),i=cjBasics.wrif.restoreSupported().then(function(){return g(t,a)}).then(function(e){return e||a===o?e:g(t,u(t))}),c[r]=i),i.then(function(e){return e&&(s[r]=e),l(0,e,n)})}function y(e){return cjBasics.ajax(n+"/revoke",{method:"POST",body:JSON.stringify({token:e}),headers:{"Content-Type":"application/json"},fetchAs:"json"})}var _,b,S,P,x={youtube:function(e,t){var n="https://www.youtube.com/";return-1!==t.indexOf("music.youtube.com")&&(n="https://music.youtube.com/"),cjgApis.session.noMultiAccountOrPage||!cjgApis.session.account.validSession?t?t.startsWith("http")?t:n+t:n:cjBasics.urlParams.attach(n+"signin",{feature:"masthead_switcher",action_handle_signin:"true",skip_identity_prompt:"True",pageid:e.pageId,authuser:e.authuser,next:t||null})},gmailThread:(_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b="BCDFGHJKLMNPQRSTVWXZbcdfghjklmnpqrstvwxz",S="thread-",P=function(e,t,n){if(!n)throw Error("rd");for(var r=t.length,a=n.length,o=!0,i=0;i<e.length;i++)if(e.charAt(i)!==t.charAt(0)){o=!1;break}if(o)return n.charAt(0);var s={};for(i=0;i<r;i++)s[t.charAt(i)]=i;var c=[];for(i=e.length-1;0<=i;i--){var u=e.charAt(i);if(void 0===s[u])throw Error("sd`"+e+"`"+t+"`"+u);c.push(s[u])}var l=[];for(i=c.length-1;0<=i;i--){for(var g=0,h=0;h<l.length;h++){var d,f=l[h]*r+g;a<=f?(g=(f-(d=f%a))/a,f=d):g=0,l[h]=f}for(;g;){var p=g%a;l.push(p),g=(g-p)/a}for(g=c[i],h=0;g;h++){h>=l.length&&l.push(0);var m,v=l[h]+g;a<=v?(g=(v-(m=v%a))/a,v=m):g=0,l[h]=v}}var w=[];for(i=l.length-1;0<=i;i--){var A=l[i];if(A>=n.length||A<0)throw Error("td`"+l+"`"+A);w.push(n.charAt(A))}return w.join("")},{encode:function(e){var t=[];e.threadId&&t.push(S+"f:"+e.threadId),e.messageId&&t.push("msg-f:"+e.messageId),e.mergeId&&t.push("thread-msg-f:"+e.mergeId);var n,r=t.join("|");return/^[\s\xa0]*$/.test(n=r)?n:(n=n.replace(S,""),P(window.btoa(n).replace(/=/g,""),_,b))},decode:O}),createWizPath:function(e){var t="";return e&&e.authuser&&"0"!==e.authuser&&(t+="u/"+e.authuser+"/"),e&&e.pageId&&(t+="b/"+e.pageId+"/"),t},createAccountPath:function(e){return"u/"+(e&&e.authuser||"0")+"/"}};function O(t){if((e=t)&&(-1!==e.indexOf(S)||-1!==e.indexOf("msg-"))||!/^[BCDFGHJKLMNPQRSTVWXZbcdfghjklmnpqrstvwxz]*$/.test(t))return t;var e;try{var n=f(P(t,b,_));return-1===n.indexOf(S)?S+n:n}catch(e){return t}}var B,k,q={request:function(e,t,n){return cjBasics.navigator.chromeLike?T(e,t,n).catch(function(){return N(e,t,n)}):N(e,t,n).catch(function(){return T(e,t,n)})},requestWithWebRequest:N,requestWithIframeProxy:T};function T(e,t,n){return L(e,n),(k=k||new Promise(function(e){(B=cjce.createElement("basic-iframe",{hidden:!0,src:m+"/cjg-proxy/"+d+"_"+cjBasics.uniqueId.generate()+"/",sandbox:"allow-same-origin allow-scripts"})).addEventListener("load",function(){e()}),document.head.appendChild(B)})).then(function(){return B.cjceSendFrameRequest({method:"cjgOriginRequest",value:window.btoa(JSON.stringify({url:e,parameters:t}))},m).then(function(e){return e.success?e.response:Promise.reject(e.response)})})}function L(e,t){var r=t&&t.endsWith(".google.com"),r=m,a=cjBasics.webRequest.addListener("onBeforeSendHeaders",function(e){for(var t=e.requestHeaders,n=0;n<t.length;++n)if("origin"===t[n].name.toLowerCase()){t.splice(n,1);break}return t.push({name:"Origin",value:r||m}),a.removeListener(),{requestHeaders:t}},{types:["xmlhttprequest"],urls:[e]},["blocking","requestHeaders"])}function N(e,t,n){return L(e,n),cjBasics.ajax(e,t)}var C,M,D=(C={displayName:cjBasics.lang.i18n("cj_i18n_02717","Not signed in"),authuser:"0",obfuscatedId:"ACCOUNT_ID_NONE",pageId:null,validSession:!1},M={displayName:cjBasics.lang.i18n("cj_i18n_06286","A Google user"),photoUrl:"/images/avatar.svg",authuser:"0",obfuscatedId:"me",pageId:null,validSession:!0},{noAccountData:C,missingAccountData:M,list:function(e){return window.location.href.startsWith(m+"/cjg-auth/")?H(e):function(e){var t=e||{},n=Math.floor(1e3*Math.random());n<100&&(n+=103);var r=v+"/ListAccounts?json=standard&source=ogb&md=1&cc=1&mn=1&mo=1&gpsia=1&fwput="+n;return!1!==t.listPages&&(r+="&listPages=1"),t&&t.authuser&&(r+="&authuser="+t.authuser),t&&t.pageId&&(r+="&pageId="+t.pageId),cjBasics.navigator.firefox?w(r).then(function(e){return o(e,r),E(r).catch(function(){return o(e,r+"&origin="+encodeURIComponent(m)),U(r)}).catch(function(){return o(e,r),R(r)}).then(W)}):cjBasics.navigator.chromeLike?U(r).catch(function(){return R(r)}).catch(function(){return E(r)}).then(W):E(r).catch(function(){return U(r)}).catch(function(){return R(r)}).then(W)}(e).catch(function(){return"/background.html"===window.location.pathname?[M]:H(e)})},signin:function(e){var t,n="AddSession";return e&&!1===e.validSession&&(n="AccountChooser"),z(n,{Email:"string"==typeof(t=e&&e.displayEmail)&&-1!==t.indexOf("@")&&2<t.length?t:null},"signin")},signout:function(){z("Logout",null,"signout")}});function E(e){return q.requestWithWebRequest(e,{method:"POST",credentials:"include",fetchAs:"json"},"https://www.google.com")}function R(e){return q.requestWithIframeProxy(e,{method:"POST",credentials:"include",fetchAs:"json"},"https://www.google.com")}function U(e){return cjBasics.ajax(e+"&origin="+encodeURIComponent(m),{credentials:"include",fetchAs:"text"}).then(function(e){return JSON.parse(decodeURIComponent(e.split(".postMessage")[1].split("www.google.com")[0].replace(/\\x/g,"%").replace(/\\n/g,"")).slice(2,-14))})}function W(e){return e[1].map(function(e){return{displayName:e[2],displayEmail:e[3],photoUrl:e[4],authuser:e[7]?e[7].toString():"0",pageId:e[8],validSession:0!==e[9]&&!1!==e[9],obfuscatedId:e[10],ownedBySelectedAccount:e[11]}})}function H(e){return new Promise(function(t){h.runtime.sendMessage({listAccounts:e},function(e){t(e)})})}function z(e,t,n){var r=m+"/cjg-apis/"+d+"_"+cjBasics.uniqueId.generate()+"/"+n,a=t||{};a.continue=r,a.hl=cjBasics.lang.current;var o=cjBasics.urlParams.attach(v+"/"+e,a),i=r+"*";return cjgApis.popup.create(o,i,n)}var G={getItem:function(e,t){return browserStorage.local.getItem(J(e)+"-"+t)},setItem:function(e,t,n){return browserStorage.local.setItem(J(e)+"-"+t,n)},remove:function(e,t){var n=J(e),r=Array.isArray(t)?t.map(function(e){return n+"-"+e}):n+"-"+t;return browserStorage.local.remove(r)}};function J(e){return e.obfuscatedId+"-"+e.pageId+"-cjg"}function F(t,n,e){var r=e||{};r.account||console.debug("cjgApis.request - missing account data"),r.account=r.account||cjgApis.account.missingAccountData;var a=n||{},o=r.pa;if(!0===o)return X(t,a,r);var i="optional"===o&&!0;return cjgApis.auth.requireToken(e.account,e.requiredScopes).then(function(e){return n.headers=n.headers||{},n.headers.Authorization="Bearer "+e,cjBasics.ajax(t,n)},function(e){return i?X(t,a,r).catch(function(){return Promise.reject(e)}):Promise.reject(e)})}function K(o,i,s){var r,c=m;return r=c,ve.getSapisId().then(function(e){var t=Math.floor(Date.now()/1e3),n=[t,e,r||m].join(" ");return"SAPISIDHASH "+t+"_"+sha1(n)}).then(function(e){var t=new URL(o),n=t.hostname;t.hostname="content.googleapis.com"===n||"www.googleapis.com"===n||"www.google.com"===n?"clients6.google.com":n.replace("googleapis.com","clients6.google.com");var r=s.account;i.credentials="include";var a=i.headers||{};return a.Authorization=e,a["X-Goog-AuthUser"]=r.authuser,r.pageId&&(a["x-Goog-PageId"]=r.pageId),"string"==typeof s.key&&(t.searchParams.set("key",s.key),a["X-Goog-Api-Key"]=s.key),i.headers=a,q.request(t.href,i,c)})}function X(e,t,n){return K(e,t,n).catch(function(){return K(e,t,n)})}var Z,V={getSource:Q,getIsConsumerGmail:Y,getUserDomain:function(e){return!e.validSession||Y(e)?Promise.resolve(null):Q(e).then(function(e){var t;if(-1!==(e=e.replace("domainName\\u003d","domainName=")).indexOf("domainName=")&&4<(t=e.split("domainName=")[1].split('"')[0]).length&&t.length<200&&"gmail.com"!==t&&"googlemail.com"!==t)return t;if(-1!==e.indexOf("managed by"))t=e.split("managed by")[1];else{if(-1===e.indexOf("gbpbt"))return null;t=e.split("gbpbt")[1]}return(t=t.split("<b>")[1].split("<")[0]).length<200?t:null},function(){return null})},getIsAdmin:function(e){return!e.validSession||Y(e)?Promise.resolve(null):Q(e).then(function(e){return-1!==e.indexOf('data-pid="199"')||-1!==e.indexOf("https://admin.google.com")})},getIsOne:function(t){if(!t.validSession)return Promise.resolve(!1);var n=Q(t).then(function(e){return-1!==e.indexOf("M4.02,28.27C2.73,25.8,2,22.98,2,20c0-2.87,0.68-5.59,1.88-8l-1.72-1.04C0.78,13.67,0,16.75,0,20c0,3.31,0.8,6.43,2.23,9.18L4.02,28.27z")}).then(function(e){return cjgApis.cache.setItem(t,"bm_cache_v30__account__one",e),e});return cjgApis.cache.getItem(t,"bm_cache_v30__account__one").then(function(e){return"boolean"==typeof e?e:n})}};function Q(e){var t,n,r=e.pageId+"-"+e.authuser;return Z[r]||(Z[r]=(n=!(t=e)||!t.pageId?"https://ogs.google.com/u/"+t.authuser+"/widget/app?hl=en":"https://aboutme.google.com/"+cjgApis.url.createWizPath(t)+"?hl=en",cjBasics.ajax(n,{fetchAs:"text"}))),Z[r]}function Y(e){var t=e.displayEmail;if(t)return t.endsWith("@gmail.com")||t.endsWith("@googlemail.com")}var $={getShortcuts:function(e){return cjgApis.info.getSource(e).then(function(e){var t=("["+e.split("AF_initDataCallback({")[1].split("[[[[")[1].split(']\n,"https://www.google.com/')[0]).replace("]\n,[[","<LIST_SEPARATOR>[").split("<LIST_SEPARATOR>");return[te(t[0]),te(t[1])]}).catch(function(){return[["192","1","8","36","78","23","53","49","24","51","31","6"].map(ee),["25","10","30","461","300","136","357","429","338"].map(ee)]})},setShortcuts:function(){return Promise.resolve()}};function ee(e){return[2,[e]]}function te(e){return JSON.parse("["+e+"]").map(function(e){return ee(e[0])})}var ne,re,ae,oe,ie,se,ce,ue,le,ge,he,de=(ce="",ue=se=ie=!(Z={}),le=new Promise(function(e){re=e}),ge=new Promise(function(e){ae=e}),he=new Promise(function(e){oe=e}),pe(),{get account(){return ne},get wizPath(){return ce},get noMultiAccount(){return ie},get noMultiAccountOrPage(){return se},accountsList:he,multiAccountCheckReady:ge,changeAccount:fe,init:pe,ready:le});function fe(e,t){return ne=e,browserStorage.local.setItem("bm_pref__account__current",ne).then(function(){t||(h.runtime.sendMessage({reloadAllInstances:!0}),window.location.reload())})}function pe(){return ue||(ue=!0,browserStorage.local.getItem("bm_pref__account__current").then(function(e){ne=e||cjgApis.account.missingAccountData,ce=cjgApis.url.createWizPath(ne),re(ne),oe(cjgApis.account.list({authuser:ne.authuser})),ne.authuser&&"0"!==ne.authuser&&ne.validSession?ae():he.then(function(e){if(!Array.isArray(e)||e.length<2)return ie=se=!0,void ae();for(var t=0;t<e.length;t++)if("1"===e[t].authuser)return void ae();ie=!0,ae()}),he.then(function(e){if(Array.isArray(e)&&0!==e.length&&e[0].validSession){for(var t=0;t<e.length;t++){var n=e[t];if(ne.obfuscatedId===n.obfuscatedId&&ne.pageId===n.pageId)return n.validSession?void(ne.validSession&&ne.displayEmail===n.displayEmail&&ne.authuser===n.authuser?ne.photoUrl===n.photoUrl&&ne.displayName===n.displayName||fe(n,!0):fe(n)):void fe(e[0])}fe(e[0])}else"ACCOUNT_ID_NONE"!==ne.obfuscatedId&&fe(cjgApis.account.noAccountData)})})),le}var me,ve=(me={groups:"groupsloginpref",play:"PLAY_ACTIVE_ACCOUNT",sites:"SITESM",store:"PLAY_ACTIVE_ACCOUNT"},{getLoginEmail:function(e){return we(me[e],"https://"+e+".google.com").then(Ae)},getSapisId:function(){return we("SAPISID",m)}});function we(n,r){return new Promise(function(t){h.cookies.get({name:n,url:r},function(e){h.runtime.lastError&&"SAPISID"===n&&"https://www.google.com"===r?t(we("SAPISID","https://accounts.google.com")):t(e?e.value:null)})})}function Ae(e){if(!e)return null;var t=e.split("=")[1];return-1===t.indexOf("@")?null:t}function je(e){var t,n,r=(t=e[0],n={amp:"&",lt:"<",le:"≤",gt:">",ge:"≥",quot:'"',"#039":"'"},t.replace(/&([^;]+);/g,function(e,t){return n[t]||""})),a=e[3],o=a&&a.b&&a.c?(r+="– "+a.b,a.c):r.split(/<b>|<\/b>/g).join(""),i={value:o};return-1!==r.indexOf("<b>")&&(i.domFragment=cjBasics.htmlToFragment(r.replace(/<i>|<\/i>/g,""))),i}var Ie,ye,_e,be=(Ie="https://mail.google.com",ye="https://www.google.com",_e="https://maps.google.com",{handleOpenUrlMessage:function(e,t,n){if("string"==typeof e&&e.startsWith("!_{")){if(!((e=JSON.parse(e.replace("!_",""))).s&&e.s.startsWith("/"+t)&&Array.isArray(e.a)&&e.a[0]))return;return function e(t,n){if(Array.isArray(t)){if(Array.isArray(t[0])){var r=t[0][0];if("string"==typeof r)try{var a=new URL(r),o=a.origin;return o===Ie?Ie+"/mail/u/"+n.authuser+"/"+a.hash:(a.pathname.startsWith("/maps")&&(o===_e&&(a.origin=ye),o===ye&&(a.searchParams.delete("authuser"),a.searchParams.delete("source"),a.searchParams.delete("hl"))),o.endsWith(".google.com")&&"0"!==n.authuser&&a.searchParams.set("authuser",n.authuser),a.href)}catch(e){}}for(var i=0;i<t.length;i++){var s=e(t[i],n);if(s)return s}}}(e=JSON.parse(e.a[0]),n)}},getInitData:function(e){var t=Math.round(1e8*Math.random()).toString(),n="I0_"+Date.now(),r="#"+cjBasics.urlParams.create({id:n,_gfid:n,parent:e?Ie:a,pfname:"",rpctoken:t});return{id:n,parameters:{origin:Ie,hai:"3",hc:"4,1,5,6",_gfid:n,id:n,usegapi:"1",pfname:"",rpctoken:t,jsh:"m;/_/scs/abc-static/_/js/k=gapi.gapi.en.Sj5LKyeUKoE.O/d=1/ct=zgms/rs=AHpOoo9ToCtoaz0mr9IKXAop6Eq9AIpSlw/m=__features__"},hash:r}}});return{account:D,auth:r,cache:G,info:V,ogs:$,popup:t,request:F,session:de,login:ve,url:x,suggestquery:{get:function(e){var t=cjBasics.urlParams.attach("https://suggestqueries.google.com/complete/search",{client:"serp",authuser:e.gAccount?e.gAccount.authuser:null,xhr:"t",hl:e.hl,q:e.q,gs_id:e.gs_id,ds:e.ds});return cjBasics.ajax(t,{fetchAs:"json"}).then(function(e){var t=e[1];return Array.isArray(t)&&0<t.length?t:null}).then(function(e){return e?e.map(je):null})}},companion:be}}();