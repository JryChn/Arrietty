"use strict";function bmCreateNewPopup(u){var a="undefined"!=typeof chrome&&chrome.runtime?chrome:"undefined"!=typeof browser&&browser;a.windows.create({type:"popup",width:600,height:600,top:u.topPosition||64,left:u.leftPosition||3e3,url:u.requestUrl},function(e){var r=e.tabs[0].id,t=e.id;function o(){a.tabs.onRemoved.removeListener(i),a.runtime.onMessage.removeListener(n),a.webRequest.onBeforeRequest.removeListener(s)}function n(e){e.closeAuthPopup&&(a.windows.remove(t),o())}function i(e){e===r&&o()}function s(e){if(!cjBasics.navigator.firefox){var t=new URL(e.url),o=t.hash||"#";"signin"===u.method?o="#signin":"signout"===u.method&&(o="#signout"),cjBasics.navigator.mac&&(o+="--macpopup");var n=window.location.origin+"/cjg-popup.html"+t.search+o;return a.tabs.update(r,{url:n}),{redirectUrl:n}}}a.runtime.onMessage.addListener(n),a.tabs.onRemoved.addListener(i),a.webRequest.onBeforeRequest.addListener(s,{tabId:r,urls:[u.redirectUrl],types:["main_frame"]},["blocking"])})}