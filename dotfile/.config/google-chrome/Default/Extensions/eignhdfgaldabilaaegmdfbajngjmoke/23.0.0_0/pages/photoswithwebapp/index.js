"use strict";cjce.registerTemplate("bm-p-photoswithwebapp",function(e,a){var l,s,t,o,r,_,h,d,c,i=!cjBasics.wrif.supported||a.missingGooglePermission||!a.account.validSession,n="https://photos.google.com",m="/"+a.wizPath,b=n+m,j="",u=cjBasics.lang.i18n("cj_i18n_00291","Home"),p={photos:{iconName:"__mdi:photo",label:cjBasics.lang.i18n("cj_i18n_00429","Photos"),newTabUrl:!0},foryou:{iconName:"__mdi:assistant",label:cjBasics.lang.i18n("cj_i18n_01055","For you"),newTabUrl:!0},photobooks:{iconName:"__mdi:auto_stories",label:cjBasics.lang.i18n("cj_i18n_00868","Photo books"),newTabUrl:!0,divider:!0},libraryHeader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_00131","Library")},albums:{iconName:"__mdi:photo_album",label:cjBasics.lang.i18n("cj_i18n_00400","Albums"),newTabUrl:!0},managelibrary:{iconName:"__mdi:library_add_check",label:cjBasics.lang.i18n("cj_i18n_06596","Utilities"),newTabUrl:!0},archive:{iconName:"__mdi:archive",label:cjBasics.lang.i18n("cj_i18n_00821","Archive"),newTabUrl:!0},trash:{iconName:"__mdi:delete",label:cjBasics.lang.i18n("cj_i18n_00005","Bin"),newTabUrl:!0,divider:!0},sharing:{iconName:"__mdi:chat_bubble_outline",label:cjBasics.lang.i18n("cj_i18n_01328","Sharing"),newTabUrl:!0},settings:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0},apps:{iconName:"__mdi:devices",label:cjBasics.lang.i18n("cj_i18n_01322","App downloads"),newTabUrl:!0},search:{label:cjBasics.lang.i18n("cj_i18n_00085","Search")},places:{label:cjBasics.lang.i18n("cj_i18n_06563","Places")},things:{label:cjBasics.lang.i18n("cj_i18n_06586","Things")},unsaved:{label:cjBasics.lang.i18n("cj_i18n_06587","Unsaved")},"search/_tv_":{label:cjBasics.lang.i18n("cj_i18n_00014","Videos")},"search/_m1_":{label:cjBasics.lang.i18n("cj_i18n_06588","360 Photos & Videos")},"search/_m3_":{label:cjBasics.lang.i18n("cj_i18n_06585","Motion photos")},"search/_m4_":{label:cjBasics.lang.i18n("cj_i18n_06584","Animations")},"search/_m5_":{label:cjBasics.lang.i18n("cj_i18n_00480","Movies")},"search/_m6_":{label:cjBasics.lang.i18n("cj_i18n_06589","Collages")},"search/_m7_":{label:cjBasics.lang.i18n("cj_i18n_06590","PhotoScan")},"search/_m8_":{label:cjBasics.lang.i18n("cj_i18n_00692","Favourites")},"search/_m9_":{label:cjBasics.lang.i18n("cj_i18n_01740","Archived")},"search/_m10_":{label:cjBasics.lang.i18n("cj_i18n_06591","Creations")},"search/_tra_":{label:cjBasics.lang.i18n("cj_i18n_06592","Recently added")},activities:{label:cjBasics.lang.i18n("cj_i18n_06593","Activity log")},unsupportedvideos:{label:cjBasics.lang.i18n("cj_i18n_06611","Unsupported videos")},printstore:{label:cjBasics.lang.i18n("cj_i18n_06612","Print store")},people:{label:cjBasics.lang.i18n("cj_i18n_00295","People")}},g=["search/_tv_","search/_m1_","search/_m3_","search/_m4_","search/_m5_","search/_m6_","search/_m7_","search/_m8_","search/_m9_","search/_m10_","search/_tra_"],v=["photos","foryou","photobooks","libraryHeader","albums","managelibrary","archive","trash","settings","sharing"];if(i){l=cjce.createElement("bm-ogb",{serviceIcon:"photos",serviceLabel:cjBasics.lang.i18n("cj_i18n_00429","Photos"),pageLabel:cjBasics.lang.i18n("cj_i18n_01167","Links"),searchbox:{submitInNewTab:!0,onSubmit:N},bmApis:a,onNewTab:A}),e.appendChild(l),a.setOnPageDisplayHandler(l.cjceSearchboxEl.select);var B=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"});return e.appendChild(B),s=cjce.createElement("bm-navlist",{items:v.map(function(e){return p[e]}),onClick:T,onNewTab:T}),void B.appendChild(s)}var f={search:'path[d="M20.49 19l-5.73-5.73C15.53 12.2 16 10.91 16 9.5A6.5 6.5 0 1 0 9.5 16c1.41 0 2.7-.47 3.77-1.24L19 20.49 20.49 19zM5 9.5C5 7.01 7.01 5 9.5 5S14 7.01 14 9.5 11.99 14 9.5 14 5 11.99 5 9.5z"]',addToArchive:'path[d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"], button[aria-label*="Add to archive"]',createAlbum:'path[d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-8-2h2v-4h4v-2h-4V7h-2v4H7v2h4z"], button[aria-label*="Create album"]',upload:'path[d="M4 15h2v3h12v-3h2v3c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2m4.41-7.59L11 7.83V16h2V7.83l2.59 2.59L17 9l-5-5-5 5 1.41 1.41z"],path[d="M4 15h2v3h12v-3h2v3c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2m4.41-7.59L11 7.83V16h2V7.83l2.59 2.59L17 9l-5-5-5 5 1.41 1.41z"]'};function C(e){c.cjceSendFrameCommand({method:"bmCstClickDomElement",value:f[e]},n)}function w(){c.cjceSendFrameCommand({method:"bmCstNavigateBack"},n)}function S(e){a.openTab(b+e)}function T(e,a){S("home"===e?"":e)}function N(e){S("search/"+encodeURIComponent(e))}function A(){S("")}function U(e){var a="photos"!==e&&e?e:"";c.cjceSendFrameCommand({method:"bmCstUpdatePath",value:m+a},n)}function k(e){e.startsWith("activities/")&&(e="activities");var a,c=!e||"photos"===e,i=!0;if(e.startsWith("search"))for(var n=0;n<g.length;n++){var s=g[n];if(e.startsWith(s)){e=s,i=!1;break}}else i=!1;r.hidden=i,o.hidden="sharing"===e,_.hidden=!(c&&"albums"!==e),h.hidden="albums"!==e,d.hidden="archive"!==e,l.cjceSetBackState(!c),t.hidden=!i,l.cjceSetNavigatorCollapseState(i),i?(t.focus(),setTimeout(function(){t.focus()},50),setTimeout(function(){t.focus()},500),t.value=j&&t.value===j?j:e.split("/")[1]||""):(j="",t.value="",a="home"===e||"photos"===e?u:p[e]&&p[e].label||e,l.cjceSetPageLabel(a))}var P,H,L=cjBasics.uniqueId.generate();P=(l=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,withShadow:!0,floating:!0,serviceIcon:"photos",serviceLabel:cjBasics.lang.i18n("cj_i18n_00429","Photos"),pageLabel:u,searchbox:{collapsable:!0,onSubmit:function(e){var a="search";e&&(a+="/"+encodeURIComponent(e)),U(a)},onMetaSubmit:N},bmApis:a,onNewTab:function(){c.cjceGetCleanUrl(n).then(function(e){e?a.openTab(e):A()})},onBack:w})).cjceDrawerEl,(t=l.cjceSearchboxEl).hidden=!0,a.setOnPageDisplayHandler(t.select),e.appendChild(l),(h=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:add_box",label:cjBasics.lang.i18n("cj_i18n_06594","Create album"),onClick:function(){C("createAlbum")}})).hidden=!0,l.cjceAppendChild(h),(d=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:add",label:cjBasics.lang.i18n("cj_i18n_06595","Add photos"),onClick:function(){C("addToArchive")}})).hidden=!0,l.cjceAppendChild(d),_=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:file_upload",label:cjBasics.lang.i18n("cj_i18n_01326","Upload"),onClick:function(){C("upload")}}),l.cjceAppendChild(_),r=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:search",label:cjBasics.lang.i18n("cj_i18n_00085","Search"),onClick:function(){C("search"),k("search")}}),l.cjceAppendChild(r),o=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:chat_bubble_outline",label:cjBasics.lang.i18n("cj_i18n_01328","Sharing"),onClick:function(){U("sharing")}}),l.cjceAppendChild(o),s=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:"photos",items:v.map(function(e){var a=p[e];return a.id=e,a}),onChange:function(e){U(e),k(e)},onNewTab:T}),P.appendChild(s),cjBasics.webRequest.handleIframeHeaders([n+"/*bm_iid="+L+"*"],{disableOgs:n,handleSwCache:!0,handleFirefoxInject:!0}),cjBasics.webRequest.addListener("onBeforeSendHeaders",function(e){for(var a,c=e.requestHeaders,i=0;i<c.length;i++){"user-agent"===c[i].name.toLowerCase()&&(a=navigator.userAgent.split(" ").map(function(e){return e.startsWith("Chrome/")?"Chrome/10.0.3729.131":e}).join(" "),c[i].value=a)}return{requestHeaders:c}},{urls:["https://photos.google.com/*bm_iid="+L+"*"],types:["sub_frame"]},["blocking","requestHeaders"]),H=cjBasics.urlParams.attach(b,{bm_cid:"photoswithwebapp",bm_iid:L,bm_wiz:"1",bm_cst:"1",lfhs:"1",hl:cjBasics.lang.current}),c=cjce.createElement("bm-iframe",{src:H,solid:"#fff",onMessage:function(e){var a,c,i=e.bm_method,n=e.bm_value;"photoswithwebappUpdatePath"===i&&((c=p[a=n]||a.startsWith("search/")||a.startsWith("activities/"))&&k(a),s.cjceSelectedId=a,l.hidden=!c)},onLoad:function(){l.cjceSetLoading(!1)}}),e.appendChild(c)});