"use strict";cjce.registerTemplate("bm-p-news",function(e,r){var i,n,c,a,t,l,s="auto",o="headlines",u="https://newsstand.google.com",d="https://news.google.com",_=d+"/"+r.wizPath,m=d+"/rss/",b="headlines/section/topic/",v=d+"/"+b,h="search/section/q/",p=[{value:"auto",label:cjBasics.lang.i18n("cj_i18n_01344","Auto detect"),selected:!0},{value:"ar_me",label:"Arabic (العالم العربي)"},{value:"es_ar",label:"Argentina (Español)‎"},{value:"au",label:"Australia‎"},{value:"de_at",label:"Austria (Österreich)‎"},{value:"bn_bd",label:"Bangladesh (বাংলাদেশ)‎"},{value:"nl_be",label:"Belgium (België)‎"},{value:"fr_be",label:"Belgium (Belgique)‎"},{value:"en_bw",label:"Botswana‎"},{value:"pt-BR_br",label:"Brazil (Brasil)‎"},{value:"bg_bg",label:"Bulgaria (България)‎"},{value:"ca",label:"Canada (English)‎"},{value:"fr_ca",label:"Canada (Français)‎"},{value:"es_cl",label:"Chile (Español)‎"},{value:"cn",label:"China (中国)‎"},{value:"es_co",label:"Colombia (Español)‎"},{value:"es_cu",label:"Cuba (Español)‎"},{value:"cs_cz",label:"Czech Republic (Česká republika)‎"},{value:"ar_eg",label:"Egypt (مصر)"},{value:"en_et",label:"Ethiopia‎"},{value:"fr",label:"France (Français)‎"},{value:"de",label:"Germany (Deutschland)‎"},{value:"en_gh",label:"Ghana‎"},{value:"el_gr",label:"Greece (Ελλάδα)‎"},{value:"hk",label:"Hong Kong (香港)‎"},{value:"hu_hu",label:"Hungary (Magyarország)‎"},{value:"in",label:"India‎"},{value:"hi_in",label:"India (हिन्दी)‎"},{value:"ta_in",label:"India (தமிழ்)‎"},{value:"te_in",label:"India (తెలుగు)‎"},{value:"ml_in",label:"India (മലയാളം)‎"},{value:"id_id",label:"Indonesia (Bahasa Indonesia)‎"},{value:"en_ie",label:"Ireland‎"},{value:"en_il",label:"Israel (English)‎"},{value:"iw_il",label:"Israel (ישראל)"},{value:"it",label:"Italy (Italia)‎"},{value:"jp",label:"Japan (日本)‎"},{value:"en_ke",label:"Kenya‎"},{value:"kr",label:"Korea (한국)‎"},{value:"ar_sa",label:"KSA (السعودي)"},{value:"lv_lv",label:"Latvia (Latvija)‎"},{value:"ar_lb",label:"Lebanon (لبنان)"},{value:"lt_lt",label:"Lithuania (Lietuva)‎"},{value:"en_my",label:"Malaysia‎"},{value:"es_mx",label:"México (Español)‎"},{value:"fr_ma",label:"Morroco (Maroc)‎"},{value:"en_na",label:"Namibia‎"},{value:"nl_nl",label:"Netherlands (Nederland)‎"},{value:"nz",label:"New Zealand‎"},{value:"en_ng",label:"Nigeria‎"},{value:"no_no",label:"Norway (Norge)‎"},{value:"en_pk",label:"Pakistan‎"},{value:"es_pe",label:"Perú (Español)‎"},{value:"en_ph",label:"Philippines‎"},{value:"pl_pl",label:"Poland (Polska)‎"},{value:"pt-PT_pt",label:"Portugal (Português)‎"},{value:"ro_ro",label:"Romania (România)‎"},{value:"ru_ru",label:"Russia (Россия)‎"},{value:"fr_sn",label:"Senegal (Sénégal)‎"},{value:"sr_rs",label:"Serbia (Србија)‎"},{value:"en_sg",label:"Singapore‎"},{value:"sk_sk",label:"Slovakia (Slovensko)‎"},{value:"sl_si",label:"Slovenia (Slovenija)‎"},{value:"en_za",label:"South Africa‎"},{value:"es",label:"Spain (España)‎"},{value:"sv_se",label:"Sweden (Sverige)‎"},{value:"de_ch",label:"Switzerland (Schweiz)‎"},{value:"fr_ch",label:"Switzerland (Suisse)‎"},{value:"tw",label:"Taiwan (台灣)‎"},{value:"en_tz",label:"Tanzania‎"},{value:"th_th",label:"Thailand (ประเทศไทย)‎"},{value:"tr_tr",label:"Turkey (Türkiye)‎"},{value:"uk",label:"U.K.‎"},{value:"us",label:"U.S.‎"},{value:"ar_ae",label:"UAE (الإمارات)"},{value:"en_ug",label:"Uganda‎"},{value:"ru_ua",label:"Ukraine (Украина / русский)‎"},{value:"uk_ua",label:"Ukraine (Україна / українська)‎"},{value:"es_us",label:"United States (Estados Unidos)‎"},{value:"es_ve",label:"Venezuela (Español)‎"},{value:"vi_vn",label:"Vietnam (Việt Nam)‎"},{value:"en_zw",label:"Zimbabwe‎"}],g={HEADLINE:{iconName:"__mdi:news",newTabUrl:v+"HEADLINE",label:cjBasics.lang.i18n("cj_i18n_01345","Headlines")},WORLD:{iconName:"__mdi:language",newTabUrl:v+"WORLD",label:cjBasics.lang.i18n("cj_i18n_00021","World")},NATION:{iconName:"__mdi:flag",newTabUrl:v+"NATION",label:cjBasics.lang.i18n("cj_i18n_00022","Your country")},BUSINESS:{iconName:"__mdi:business",newTabUrl:v+"BUSINESS",label:cjBasics.lang.i18n("cj_i18n_00023","Business")},TECHNOLOGY:{iconName:"__mdi:memory",newTabUrl:v+"TECHNOLOGY",label:cjBasics.lang.i18n("cj_i18n_01347","Technology")},ENTERTAINMENT:{iconName:"__mdi:theaters",newTabUrl:v+"ENTERTAINMENT",label:cjBasics.lang.i18n("cj_i18n_00025","Entertainment")},SPORTS:{iconName:"__mdi:directions_bike",newTabUrl:v+"SPORTS",label:cjBasics.lang.i18n("cj_i18n_00026","Sports")},SCIENCE:{iconName:"__mdi:experiment",newTabUrl:v+"SCIENCE",label:cjBasics.lang.i18n("cj_i18n_01346","Science")},HEALTH:{iconName:"__mdi:fitness_center",newTabUrl:v+"HEALTH",label:cjBasics.lang.i18n("cj_i18n_00027","Health")}};function j(s){var e,o=s.q;if(!o&&!0!==s.noCache)return e=s,browserStorage.local.getItem("bm_cache_v30__news__"+e.topic).then(function(e){return s.noCache=!0,e?{items:e,freshRequest:function(){return j(s)}}:j(s)});var a=m+b+s.topic;o&&(a=m+h+o);var n=cjBasics.urlParams.attach(a,{ned:s.ned});return cjBasics.ajax(n,{fetchAs:"xml"}).then(function(e){for(var a={items:[]},n=e.querySelectorAll("rss > channel > item"),l=0;l<n.length;l++){var t=n[l],i={};i.title=t.querySelector("title").textContent.split(" - ")[0],i.url=t.querySelector("link").textContent;var c=t.querySelector("source"),r=c&&c.textContent;r&&(i.newsProvider=r),a.items.push(i)}return o||browserStorage.local.setItem("bm_cache_v30__news__"+s.topic,a.items),a})}function C(e){var n=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"});return c.cjceSetLoading(!0),j({q:e.q||null,topic:e.topic||"HEADLINE",ned:e.ned||"auto"}).then(function e(a){a.freshRequest?a.freshRequest().then(e):c.cjceSetLoading(!1),n.textContent="",a.items.forEach(function(e){var a=function(e){var a=cjce.createElement("cjmd-card",{withPadding:!0,onClick:function(){r.openTab(e.url)}});a.classList.add("bm-p-news-card");var n=document.createElement("header");n.className="bm-p-news-card__header",a.appendChild(n);var l=document.createElement("div");l.className="bm-p-news-card__main",n.appendChild(l);var t=cjce.createElement("cjmd-title",{label:e.title});l.appendChild(t);var i,c=document.createElement("div");return c.className="cjmd-secondarytext",c.textContent=e.newsProvider,l.appendChild(c),e.img&&((i=document.createElement("div")).className="bm-p-news-card__thumbnail",i.style.backgroundImage="url('"+e.img+"')",n.appendChild(i)),a}(e);n.appendChild(a)})}),n}function w(){return l=l||browserStorage.sync.getItem("bm_pref__news__edition").then(function(e){s=e||s||"auto"})}function E(e){var a="publications/";"TOPIC"===e.kind&&(a="topics/");var n=_+a+e.id;r.openTab(n)}var f,N={headlines:{label:cjBasics.lang.i18n("cj_i18n_00020","Top stories"),iconName:"__mdi:play_newsstand",newTabUrl:_},foryou:{label:cjBasics.lang.i18n("cj_i18n_01055","For you"),iconName:"__mdi:for_you",newTabUrl:_+"foryou",external:!0},library:{label:cjBasics.lang.i18n("cj_i18n_01339","Topics/sources"),iconName:"__mdi:star_outline",newTabUrl:_+"my/library"},searches:{label:cjBasics.lang.i18n("cj_i18n_01372","Saved searches"),iconName:"__mdi:saved_search",newTabUrl:_+"my/searches"},magazines:{label:cjBasics.lang.i18n("cj_i18n_00132","Magazines"),iconName:"__mdi:auto_stories",newTabUrl:_+"my/magazines"},bookmarks:{label:cjBasics.lang.i18n("cj_i18n_01341","Saved stories"),iconName:"__mdi:bookmark_border",newTabUrl:_+"my/bookmarks",external:!0,divider:!0},covid19:{label:cjBasics.lang.i18n("cj_i18n_06392","COVID-19"),iconName:"__mdi:local_hospital",newTabUrl:_+"/topics/CAAqIggKIhxDQkFTRHdvSkwyMHZNREZqY0hsNUVnSmxiaWdBUAE",divider:!0}};function S(a){i.textContent="";var n=cjce.createElement("cjmd-container");i.appendChild(n),w().then(function(){var e=C({q:a,ned:s,shadow:"transparentOnScroll"});n.appendChild(e)})}function y(e){var a=cjBasics.urlParams.attach(u+"/"+e,{hl:cjBasics.lang.current,authuser:r.account.authuser});return cjBasics.ajax(a).then(function(e){return JSON.parse(e.replace(")]}',","")).data.items||[]})}function T(e,a){if(0===e.length)return cjce.createElement("cjmd-emptystate",{label:cjBasics.lang.i18n("cj_i18n_01342","No items found"),iconName:"__mdi:news"});for(var n,l=cjce.createElement("cjmd-grid"),t=0;t<e.length;t++){a===("SAVED_SEARCH"===e[t].kind)&&(n=function(e){var a=cjce.createElement("cjmd-griditem",{onClick:function(){E(e)}}),n=document.createElement("div");n.className="bm-p-news-item__thumbnail";var l=e.icon&&e.icon.image.url;l&&(n.style.backgroundImage='url("'+l+'")'),"TOPIC"===e.kind&&(n.style.backgroundColor=e.theme.background),a.appendChild(n);var t=document.createElement("div");t.className="cjmd-grid__item__bottom",a.appendChild(t);var i=document.createElement("div");i.className="cjmd-grid__item__textcontainer",t.appendChild(i);var c=document.createElement("div");return c.textContent=e.title,i.appendChild(c),a}(e[t]),l.appendChild(n))}return l}function I(n){c.cjceSetLoading(!0),i.textContent="";var l=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"transparentOnScroll"});i.appendChild(l);var t="";cjgApis.cache.getItem(r.account,"bm_cache_v30__news__library").then(function(e){var a;Array.isArray(e)&&(t=JSON.stringify(e),a=T(e,n),l.appendChild(a))}),y("api/library/subscriptions").then(function(e){var a;c.cjceSetLoading(!1),JSON.stringify(e)!==t&&(l.textContent="",cjgApis.cache.setItem(r.account,"bm_cache_v30__news__library",e),a=T(e,n),l.appendChild(a))})}function B(e){if(0===e.length)return cjce.createElement("cjmd-emptystate",{label:cjBasics.lang.i18n("cj_i18n_01342","No items found"),iconName:"__mdi:news"});for(var a=cjce.createElement("cjmd-grid"),n=0;n<e.length;n++){var l=function(e){var a=cjce.createElement("cjmd-griditem",{onClick:function(){E(e)}}),n=document.createElement("div");n.className="bm-p-news-item__thumbnail bm-p-news-item__thumbnail--tall",n.style.backgroundImage='url("'+e.image.url+'")',"TOPIC"===e.kind&&(n.style.backgroundColor=e.theme.background),a.appendChild(n);var l=document.createElement("div");l.className="cjmd-grid__item__bottom",a.appendChild(l);var t=document.createElement("div");t.className="cjmd-grid__item__textcontainer",l.appendChild(t);var i=document.createElement("div");i.textContent=e.magazineTitle.title,t.appendChild(i);var c=document.createElement("div");return c.className="cjmd-secondarytext",c.textContent=e.title,t.appendChild(c),a}(e[n]);a.appendChild(l)}return a}function k(){c.cjceSetLoading(!0);var n="HEADLINE";i.textContent="",t||(t=cjce.createElement("cjmd-appbar",{secondary:!0}),c.appendChild(t));var a=cjce.createElement("cjmd-container");function l(){var e=C({q:a.textContent="",ned:s,topic:n,shadow:"thinOnScroll"});a.appendChild(e)}i.appendChild(a),w().then(function(e){var a=cjce.createElement("cjmd-tabs",{itemLimit:4,items:g,onMetaClick:function(e){var a=g[e].newTabUrl;r.openTab(a)},onChange:function(e){n=e,l()},selectedId:"HEADLINE"});t.textContent="",t.appendChild(a),c.cjceSetLoading(!1),l()})}function A(){t&&(t.hidden="headlines"!==o),"headlines"===o?k():"covid19"===o?S(cjBasics.lang.i18n("cj_i18n_06392","COVID-19")):"library"===o?I(!1):"searches"===o?I(!0):function(){c.cjceSetLoading(!0),i.textContent="";var n=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"transparentOnScroll"});i.appendChild(n);var l="";cjgApis.cache.getItem(r.account,"bm_cache_v30__news__magazines").then(function(e){var a;Array.isArray(e)&&(l=JSON.stringify(e),a=B(e),n.appendChild(a))}),y("api/library/magazines").then(function(e){var a;c.cjceSetLoading(!1),JSON.stringify(e)!==l&&(n.textContent="",cjgApis.cache.setItem(r.account,"bm_cache_v30__news__magazines",e),a=B(e),n.appendChild(a))})}()}c=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,serviceIcon:"news",serviceLabel:cjBasics.lang.i18n("cj_i18n_00425","News"),pageLabel:N[o].label,searchbox:{suggestHandler:function(e){return cjgApis.suggestquery.get({gAccount:r.account,hl:cjBasics.lang.current,q:e,ds:"n"})},onClear:function(){A()},onSubmit:function(e){S(e)},onMetaSubmit:function(e){var a=cjBasics.urlParams.attach("https://www.google.com/search",{tbm:"nws",q:e,authuser:r.account.authuser});r.openTab(a)}},bmApis:r,onNewTab:function(){var e=N[o].newTabUrl;r.openTab(e)}}),e.appendChild(c),n=c.cjceDrawerEl,f=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:"headlines",items:N,onChange:function(e){var a=N[o=e].label;c.cjceSetPageLabel(a),A()},onNewTab:function(e,a){r.openTab(a.newTabUrl)}}),n.appendChild(f),w().then(function(){var a=cjce.createElement("bm-drawerdropdown",{iconName:"__mdi:language",label:cjBasics.lang.i18n("cj_i18n_01343","Change edition"),selectedId:s,items:p,onChange:function(){var e=a.cjceSelectedId;browserStorage.sync.setItem("bm_pref__news__edition",e),s=e,k()}});n.appendChild(a)}),a=c.cjceSearchboxEl,r.setOnPageDisplayHandler(a.select),i=cjce.createElement("cjmd-container"),e.appendChild(i),A()});