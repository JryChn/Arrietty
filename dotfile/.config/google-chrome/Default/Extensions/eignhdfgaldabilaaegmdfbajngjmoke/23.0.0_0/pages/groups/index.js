"use strict";cjce.registerTemplate("bm-p-groups",function(t,l){var o="https://groups.google.com",n=o+"/"+l.wizPath,a="";"0"===l.account.authuser&&(a="u/"+l.account.authuser+"/");var i,s,e,m,r,_,d,u,g,p=!1,j=!1,b="public",h="home",f=h,v=cjBasics.uniqueId.generate(),B=cjBasics.lang.i18n("cj_i18n_01366","Searches");function c(e){var c;h!==e&&(c="search"===e,_.hidden=c,r.hidden=!c,d.hidden="search"===e,i.cjceSetBackState(c),i.cjceSetNavigatorCollapseState(c),"search"!==h&&(f=h),c?(i.cjceSetPageLabel(B),r.select()):(i.cjceSetPageLabel(S[e].label),cjgApis.cache.setItem(l.account,"bm_pref__groups__lastused",e)),h=e,g.cjceSelectedId=e,s.textContent="",m&&E())}cjBasics.webRequest.handleIframeHeaders([o+"/*bm_iid="+v+"*"]);var y={"pending-messages":{label:cjBasics.lang.i18n("cj_i18n_06619","Pending messages"),iconName:"__mdi:assignment",divider:!0},members:{label:cjBasics.lang.i18n("cj_i18n_06618","Members"),iconName:"__mdi:people"},"pending-members":{label:cjBasics.lang.i18n("cj_i18n_06617","Pending members"),iconName:"__mdi:how_to_reg"},"banned-users":{label:cjBasics.lang.i18n("cj_i18n_06616","Banned users"),iconName:"__mdi:block",divider:!0},about:{label:cjBasics.lang.i18n("cj_i18n_00838","About"),iconName:"__mdi:info"},membership:{label:cjBasics.lang.i18n("cj_i18n_06615","My membership settings"),iconName:"__mdi:person"},settings:{label:cjBasics.lang.i18n("cj_i18n_06614","Group settings"),iconName:"__mdi:settings"}},S={home:{label:cjBasics.lang.i18n("cj_i18n_00291","Home"),iconName:"__mdi:home",newTabUrl:!0},"my-groups":{label:cjBasics.lang.i18n("cj_i18n_00388","My groups"),iconName:"__mdi:people",newTabUrl:!0},recent:{label:cjBasics.lang.i18n("cj_i18n_06607","Recent groups"),iconName:"__mdi:access_time",newTabUrl:!0},favorites:{label:cjBasics.lang.i18n("cj_i18n_06613","Favourite groups"),iconName:"__mdi:folder_special",newTabUrl:!0},"all-groups":{label:cjBasics.lang.i18n("cj_i18n_06606","All groups"),iconName:"__mdi:business",newTabUrl:!0,external:!0,divider:!0},starred:{label:cjBasics.lang.i18n("cj_i18n_06605","Starred topics"),iconName:"__mdi:star_outline",newTabUrl:!0,oldui:!0,external:!0},"usersettings/general":{label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),iconName:"__mdi:settings",newTabUrl:!0,oldui:!0,external:!0}};function w(){var c={public:{label:cjBasics.lang.i18n("cj_i18n_01368","Public groups"),iconName:"__mdi:public"}};m?m.domains.forEach(function(e){c[e]={label:e,iconName:"__mdi:domain"}}):b&&"public"!==b&&(c[b]={label:b,iconName:"__mdi:domain"});var e=u;u=cjce.createElement("cjmd-iconbuttonmenu",{label:cjBasics.lang.i18n("cj_i18n_01375","Choose domain"),iconName:"__mdi:business",isSelector:!0,selectedId:b,onChange:function(e){var c=(b=e)&&"public"!==b?b:cjBasics.lang.i18n("cj_i18n_01368","Public groups");i.cjceSetServiceLabel(c),cjgApis.cache.setItem(l.account,"bm_pref__groups__domain",b),s.textContent="",T(b)},items:c}),e?e.parentNode.replaceChild(u,e):i.cjceAppendChild(u)}function N(e,c){var n="";b&&"public"!==b&&(n+="a/"+b+"/"),n+="g/"+e,c&&"approved-messages"!==c&&(n+="/"+c),I(n)}function C(e,c,o){var n;c&&(n=cjce.createElement("cjmd-subheader",{color:!0,label:c}),s.appendChild(n));var r=cjce.createElement("cjmd-list");m[e].forEach(function(e){var c,n,a,i=e.path,s=i.startsWith("forum/"),t=s&&((c=e.path).startsWith("forum/")?c.replace("forum/",""):c),l=cjce.createElement("cjmd-item",{icon:{name:o||"__mdi:people",color:"var(--secondary-body-color, #5f6368)"},label:e.label,onClick:function(e){e.target===l&&(s?N(t):P(i))}});s&&((n=document.createElement("div")).className="cjmd-item__hovertools",l.appendChild(n),a=cjce.createElement("cjmd-iconbuttonmenu",{label:cjBasics.lang.i18n("cj_i18n_06294","More actions"),items:y,compact:!0,onClick:function(e){N(t,e)}}),n.appendChild(a)),r.appendChild(l)}),s.appendChild(r)}function E(){s.textContent="";var e,c=!1;"home"===h?(m.favorites.length&&(C("favorites",cjBasics.lang.i18n("cj_i18n_00692","Favorites")),c=!0),m.recentlyViewed.length&&(C("recentlyViewed",cjBasics.lang.i18n("cj_i18n_01107","Recently viewed")),c=!0),m.recentlyPosted.length&&(C("recentlyPosted",cjBasics.lang.i18n("cj_i18n_01371","Recently posted to")),c=!0),m.myforums.length&&(c=!0,C("myforums",cjBasics.lang.i18n("cj_i18n_00388","My groups")))):"my-groups"===h?m.myforums.length&&(c=!0,C("myforums")):"favorites"===h?m.favorites.length&&(c=!0,C("favorites")):"recent"===h?(m.recentlyViewed.length&&(C("recentlyViewed",cjBasics.lang.i18n("cj_i18n_01107","Recently viewed")),c=!0),m.recentlyPosted.length&&(C("recentlyPosted",cjBasics.lang.i18n("cj_i18n_01371","Recently posted to")),c=!0)):"search"===h&&(m.savedSearches.length&&(C("savedSearches",cjBasics.lang.i18n("cj_i18n_01372","Saved searches"),"__mdi:saved_search"),c=!0),m.recentSearches.length&&(C("recentSearches",cjBasics.lang.i18n("cj_i18n_01373","Recent searches"),"__mdi:youtube_searched_for"),c=!0)),c||(e=cjce.createElement("cjmd-emptystate",{label:"search"===h?null:cjBasics.lang.i18n("cj_i18n_00386","No groups found"),subLabel:"search"===h?cjBasics.lang.i18n("cj_i18n_01374","Recent searches will appear here"):cjBasics.lang.i18n("cj_i18n_00383","To add a new group, click the add button"),iconName:"search"===h?"__mdi:search":"__mdi:forum"}),s.appendChild(e))}function P(e){var c=o;b&&"public"!==b&&(c+="/a/"+b),c=cjBasics.urlParams.attach(c+"/forum/",{authuser:p?null:l.account.authuser,oldui:"1"})+"#!"+(e||"overview"),l.openTab(c)}function I(e){var c=n+(e||"");l.openTab(c)}function A(e,c){j=0<(m=e).domains.length,c===b&&(i.cjceSetLoading(!1),E(),j&&w())}function T(c){var n;i.cjceSetLoading(!0);var s,a=!1;cjgApis.cache.getItem(l.account,"bm_cache_v30__groups__data__"+c).then(function(e){e&&!a&&(A(e,c),n=JSON.stringify(e,Object.keys(e).sort()))}),s=c,new Promise(function(a){var e=o;s&&"public"!==s&&(e+="/a/"+s),e+="/forum/";var c=cjBasics.urlParams.attach(e,{bm_cid:"groups",oldui:"1",hl:"en",bm_iid:v,authuser:l.account.authuser})+"#!myforums",i=cjce.createElement("basic-iframe",{hidden:!0,src:c,sandbox:"allow-same-origin allow-scripts",onMessage:function(e){var c=e.bm_method,n=e.bm_value;"groupsData"===c&&(i.remove(),i.src="about:blank",i=null,a(n))}});t.appendChild(i)}).then(function(e){a=!0,JSON.stringify(e,Object.keys(e).sort())!==n&&(cjgApis.cache.setItem(l.account,"bm_cache_v30__groups__data__"+c,e),A(e,c))})}cjgApis.info.getIsConsumerGmail(l.account)&&delete S["all-groups"],i=cjce.createElement("bm-ogb",{drawer:!0,loading:!0,serviceIcon:"groups",serviceLabel:cjBasics.lang.i18n("cj_i18n_01368","Public groups"),pageLabel:S[h].label,searchbox:{collapsable:!0,onSubmit:function(e){I("search?q="+encodeURIComponent(e))},submitInNewTab:!0},bmApis:l,onNewTab:function(){I(a)},onBack:function(){c(f)}}),t.appendChild(i),(r=i.cjceSearchboxEl).hidden=!0,_=cjce.createElement("cjmd-iconbutton",{label:cjBasics.lang.i18n("cj_i18n_00085","Search"),iconName:"__mdi:search",onClick:function(){c("search")}}),i.cjceAppendChild(_),e=i.cjceDrawerEl,d=cjce.createElement("gmd-fab",{label:cjBasics.lang.i18n("cj_i18n_00392","Create new group"),onClick:function(){I(a+"?create-group=1")}}),t.appendChild(d),s=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"}),l.setOnPageDisplayHandler(i.cjceSearchboxEl.select),t.appendChild(s),g=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:h,items:S,onChange:c,bmApis:l,onNewTab:function(e,c){c.oldui?P(e):I("home"===e?a:e)}}),e.appendChild(g),Promise.all([cjgApis.cache.getItem(l.account,"bm_pref__groups__lastused"),cjgApis.cache.getItem(l.account,"bm_pref__groups__domain").then(function(e){return e||cjgApis.info.getUserDomain(l.account).then(function(e){var c=e||"public";return cjgApis.cache.setItem(l.account,"bm_pref__groups__domain",c),c})})]).then(function(e){var c,n=e[0];(b=e[1])&&"public"!==b&&w(),n&&n!==h&&(c="search"===(h=n)?B:S[h].label,i.cjceSetPageLabel(c)),d.hidden="search"===h,g.cjceSelectedId=h,b&&"public"!==b&&i.cjceSetServiceLabel(b),T(b)}),cjgApis.login.getLoginEmail("groups").then(function(e){var c=l.account.displayEmail;c&&c===e&&(p=!0)})});