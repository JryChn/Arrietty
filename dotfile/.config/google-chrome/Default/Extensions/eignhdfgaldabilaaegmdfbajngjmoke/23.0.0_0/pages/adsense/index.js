"use strict";cjce.registerTemplate("bm-p-adsense",function(e,o){var t,a,n,c,r,d,l={},s=["https://www.googleapis.com/auth/adsense.readonly"],i="https://content.googleapis.com/adsense/v1.4/",m=window.atob("QUl6YVN5QXBVTVBOVFlnbW55UVUwcGdSSXdEcm42OHdGbXZ2bVp3");function _(e,a){var n,t,c,s,i=(n=e,t=a,c="https://www.google.com/adsense/new/",s=o.account.authuser,r?c+="u/"+s+"/"+r+"/":"0"!==s&&null===r&&((t=t||{}).authuser=s),c+=n||"home",t?cjBasics.urlParams.attach(c,t):c);o.openTab(i)}function u(e,a){var n=a||{};n.prettyPrint="false";var t=cjBasics.urlParams.attach(i+e,n);return cjgApis.request(t,{fetchAs:"json"},{account:o.account,pa:"optional",key:m,requiredScopes:s}).catch(y)}var p,h,j=[{label:cjBasics.lang.i18n("cj_i18n_00225","Today so far"),reportId:"today",start:"today",end:"today"},{label:cjBasics.lang.i18n("cj_i18n_00226","Yesterday"),reportId:"yesterday",start:"today-1d",end:"today-1d",previous:{label:cjBasics.lang.i18n("cj_i18n_00227","vs same day last week"),start:"today-8d",end:"today-8d"}},{label:cjBasics.lang.i18n("cj_i18n_00228","This month so far"),reportId:"thismonth",start:"startOfMonth",end:"today",previous:{label:cjBasics.lang.i18n("cj_i18n_01179","vs same period last year"),start:"startOfMonth-1y",end:"today-1y"}},{label:cjBasics.lang.i18n("cj_i18n_01181","Last 28 days"),start:"today-28d",end:"today-1d",reportId:"last30days",previous:{label:cjBasics.lang.i18n("cj_i18n_01180","vs previous 28 days"),start:"today-48d",end:"today-29d"}},{label:cjBasics.lang.i18n("cj_i18n_00232","Lifetime"),reportId:"alltime",reportCt:"tm",start:"today-100y",end:"today"}];function g(e){var a;c||(c=!0,n&&(n.hidden=!0),t.textContent="",a=cjce.createElement("bm-fulldialog",{inline:!0,bmApis:o,onNewTab:function(){_("home")},lockup:{label:cjBasics.lang.i18n("cj_i18n_00179","AdSense")},iconName:"ad_sense",message:e.message,actionLabel:e.actionLabel,actionG:e.actionG,action:e.action}),t.appendChild(a))}function b(){g({message:cjBasics.lang.i18n("cj_i18n_00233","There is no AdSense account attached to this Google account"),actionLabel:cjBasics.lang.i18n("cj_i18n_01543","Switch account"),action:function(){o.pageManager.navigate("accountchooser")}})}function y(e){if(e&&e.body&&e.body.indexOf("noAdSenseAccount"))return b();var a;"not_authorized"===e.cjg_error&&(a=e,g({message:cjBasics.lang.i18n("cj_i18n_00235","Before you can use this page, you need to give access to load your Google AdSense data"),actionLabel:cjBasics.lang.i18n("cj_i18n_01916","Continue with Google"),actionG:!0,action:function(){cjgApis.auth.requestPermissions(o.account,a.cjg_missing_scopes)}}))}function w(e){if(!r)throw b(),new Error("No AdSense Account");return u("accounts/"+r+"/reports",{startDate:e.start,endDate:e.end,metric:"EARNINGS",useTimezoneReporting:"true",fields:"headers/currency,totals"}).then(function(e){return{revenue:e.totals[0]||0,currency:e.headers[0].currency}})}function v(y){var e=cjce.createElement("cjmd-card",{withPadding:!0,interactive:!0,onClick:function(){_("main/viewreports",{rt:"d",uim:"d",d:y.reportId,ct:y.reportCt||null})}});e.classList.add("bm-p-adsense-card");var a=document.createElement("div");a.className="bm-p-adsense-card__date",a.textContent=y.label,e.appendChild(a);var v,n,t,c,s,i,f=document.createElement("div");return f.className="bm-p-adsense-card__amount",f.textContent=cjBasics.lang.i18n("cj_i18n_01174","Loading")+"...",e.appendChild(f),y.previous&&((n=document.createElement("div")).className="cjmd-secondarytext bm-p-adsense-card__comparison",n.textContent=y.previous.label,a.appendChild(n),(v=document.createElement("div")).className="bm-p-adsense-card__change",v.textContent="‚Å£",e.appendChild(v)),c=function(e){var a,n,t,c,s,i,o,r,d,l,m,_,u,p,h,j,g=e[0].revenue,b=e[0].currency;f.textContent=g+" "+b,y.previous&&e[1]&&(a=e[1].revenue,e[1].currency===b&&(t=0<(c=n=g-a)?"up":c<0?"down":"neutral",s=document.createDocumentFragment(),(i=cjce.createElement("cjmd-icon",{name:"down"==t?"__mdi:trending_down":"__mdi:trending_up"})).classList.add("bm-p-adsense-card__changeicon"),s.appendChild(i),r=g,d=a,o=(0<(l=Math.round(1e3*(r/d-1))/10)?"+":"")+l+"%",h=(m=n,_=b,u=(Math.round(100*Math.abs(m))/100).toString(),(p=u.split(".")[1])?p.length<2&&(u+="0"):u+=".00",u+" "+_)+" ("+o+")",(j=document.createElement("span")).className="bm-p-adsense-card__changetext",j.textContent=h,s.appendChild(j),v.textContent="",v.dataset.type=t,v.appendChild(s)))},s="bm_cache_v30__adsense__reports__"+(t=y).start+"__"+t.end,i=!1,cjgApis.cache.getItem(o.account,s).then(function(e){!i&&e&&c(e)}),d.then(function(){l[s]=!0;var e=[w(t)];return t.previous&&e.push(w(t.previous)),Promise.all(e)}).then(function(e){i=!0,c(e),cjgApis.cache.setItem(o.account,s,e)},function(){}),e}function f(){var n;c||(n=document.createDocumentFragment(),j.forEach(function(e){var a=v(e);n.appendChild(a)}),t.textContent="",t.appendChild(n))}h=cjce.createElement("bm-ogb",{drawer:!0,serviceIcon:"ad_sense",serviceLabel:cjBasics.lang.i18n("cj_i18n_00179","AdSense"),pageLabel:cjBasics.lang.i18n("cj_i18n_00291","Home"),bmApis:o,onNewTab:function(){_("home")}}),e.appendChild(h),a=h.cjceDrawerEl,n=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:refresh",label:cjBasics.lang.i18n("cj_i18n_01182","Refresh reports"),onClick:function(){cjgApis.cache.remove(o.account,Object.keys(l)).then(f)}}),h.cjceAppendChild(n),p=cjce.createElement("bm-navlist",{items:[{id:"home",iconName:"__mdi:home",label:cjBasics.lang.i18n("cj_i18n_00291","Home"),newTabUrl:!0,adsensePath:"home"},{iconName:"__mdi:picture_in_picture",label:cjBasics.lang.i18n("cj_i18n_01530","Ads"),newTabUrl:!0,adsensePath:"main/myads-viewall-adunits",adsenseParams:{product:"SELF_SERVICE_CONTENT_ADS"},external:!0},{iconName:"__mdi:admob",label:cjBasics.lang.i18n("cj_i18n_00580","AdMob"),newTabUrl:!0,adsensePath:"main/adMob",adsenseParams:{product:"SELF_SERVICE_G_MOB_DISPLAY_APP"},external:!0},{iconName:"__mdi:campaign_search_display",label:cjBasics.lang.i18n("cj_i18n_01149","Ads for search"),newTabUrl:!0,adsensePath:"main/myads-viewall-adunits",adsenseParams:{product:"SELF_SERVICE_SEARCH_ADS"},external:!0},{iconName:"__mdi:web",label:cjBasics.lang.i18n("cj_i18n_01150","Sites"),newTabUrl:!0,adsensePath:"sites/my-sites",external:!0,divider:!0},{iconName:"__mdi:block",label:cjBasics.lang.i18n("cj_i18n_01151","Blocking controls"),newTabUrl:!0,adsensePath:"main/allowAndBlockAds",external:!0},{iconName:"__mdi:assessment",label:cjBasics.lang.i18n("cj_i18n_01152","Reports"),newTabUrl:!0,adsensePath:"main/viewreports",adsenseParams:{rt:"d",uim:"d"},external:!0},{iconName:"__mdi:trending_up",label:cjBasics.lang.i18n("cj_i18n_01153","Optimalization"),newTabUrl:!0,adsensePath:"opt/opportunities",external:!0,divider:!0},{iconName:"__mdi:payments",label:cjBasics.lang.i18n("cj_i18n_01154","Payments"),newTabUrl:!0,adsensePath:"payments",external:!0},{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0,adsensePath:"settings",external:!0}],selectedId:"home",bmApis:o,onNewTab:function(e,a){_(a.adsensePath,a.adsenseParams)}}),a.appendChild(p),t=cjce.createElement("cjmd-container",{scrollable:"noScroll",shadow:"transparentOnScroll"}),e.appendChild(t),d=u("accounts",{fields:"items/id"}).then(function(e){return e&&Array.isArray(e.items)&&0!==e.items.length?e.items[0].id:null}).then(function(e){(r=e)||b()}),f()});