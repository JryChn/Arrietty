"use strict";cjce.registerTemplate("bm-p-classroomwithhybrid",function(e,i){var n,a,l,s,o,r,d,u,h,m,p,c,b,j,_="https://classroom.google.com",t=_+"/"+i.wizPath,g=!cjBasics.wrif.supported||cjBasics.navigator.firefox,v=cjBasics.lang.i18n("cj_i18n_00305","Classroom"),f=cjBasics.lang.i18n("cj_i18n_01255","Classes"),C=!1,y=!1,w="h",B="h",S=new Promise(function(e){a=e}),E={h:{iconName:"__mdi:home",label:cjBasics.lang.i18n("cj_i18n_01255","Classes"),newTabUrl:!0},calendar:{iconName:"__mdi:calendar_today",label:cjBasics.lang.i18n("cj_i18n_01256","Calendar"),newTabUrl:!0,divider:!0},teachingSubheader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_06577","Teaching")},ta:{iconName:"__mdi:assignment",label:cjBasics.lang.i18n("cj_i18n_06233","To do")},enrolledSubheader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_06578","Enrolled")},a:{iconName:"__mdi:assignment",label:cjBasics.lang.i18n("cj_i18n_06233","To do")},"h/archived":{iconName:"__mdi:archive",label:cjBasics.lang.i18n("cj_i18n_01257","Archived classes"),newTabUrl:!0},s:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0}};function k(e){var c,n,r,t=["h","calendar","h/archived","s"];Array.isArray(e)&&(c=[],r=!(n=[]),e.forEach(function(e){var t="c/"+e.id;e.archived?r=!0:e.enrolled?n.push(t):c.push(t);var a=e.themeData&&e.themeData.color;E[t]={color:a,label:e.label,newTabUrl:!0,colorIcon:!0,icon:{theme:"solid",name:"__mdi:class"}}}),t=["h","calendar"],0<c.length&&(t.push("teachingSubheader","ta"),t=t.concat(c),E[c[c.length-1]].divider=!0),0<n.length&&(t.push("enrolledSubheader","a"),t=t.concat(n),E[n[n.length-1]].divider=!0),r&&t.push("h/archived"),t.push("s"));var a={};t.forEach(function(e){a[e]=E[e],g&&"h"!==e&&(a[e].external=!0)});var l=cjce.createElement("bm-navlist",{selectedId:w,items:a,isSelector:!0,onChange:function(e){s.cjceSelectedId=w,A(e)},onNewTab:function(e){T(e)}}),i=o.contains(document.activeElement)&&o.classList.contains("cjmd-sheet--open");cjce.replaceChild(o,l,s),i&&o.cjceToggleState(!0),s=l}function T(e){i.openTab(t+e)}function N(e){var t=e.replace(")]}'",""),a=JSON.parse(t)[0][0][2];return C=!0,a.map(function(t){var a=Date.now().toString();try{a=t[0][0]}catch(e){"string"==typeof t[28]&&(a=t[28].replace("c:",""))}a.length<11?a+="ZZ":a.length<12&&(a+="Z"),a=window.btoa(a);var c={};try{c.color=t[9][1],c.backgroundImage=t[9][2].replace("https://gstatic.com/","https://ssl.gstatic.com/")}catch(e){c=null}return{id:a,label:t[5],subLabel:t[8],courseCode:t[10],themeData:c,archived:2===t[20],enrolled:4===t[43],calendarUrl:t[23]}})}function I(e){var t,a,c=JSON.stringify(e);c!==n&&(n=c,t=0<e.length,y||(b.hidden=!t),t&&(a=document.createDocumentFragment(),e.forEach(function(e){var t;e.archived||(t=function(e){var t=e.id,a=document.createElement("div");a.tabIndex=0,a.dataset.id="c/"+t,a.className="bm-p-classroomwithhybrid-card",g&&i.darkMode&&a.classList.add("bm-p-classroomwithhybrid-card--dark");var c=document.createElement("header");c.className="bm-p-classroomwithhybrid-card__top",e.themeData&&(c.style.backgroundColor=e.themeData.color,c.style.backgroundImage='url("'+e.themeData.backgroundImage+'")'),a.appendChild(c);var n,r,l=document.createElement("h3");return l.className="bm-p-classroomwithhybrid-card__title",l.textContent=e.label,c.appendChild(l),e.subLabel&&((n=document.createElement("div")).textContent=e.subLabel,l.appendChild(n)),g||((r=document.createElement("p")).textContent=cjBasics.lang.i18n("cj_i18n_01174","Loading")+"...",r.className="bm-p-classroomwithhybrid-card__loading",a.appendChild(r)),a}(e),a.appendChild(t))}),j.textContent="",j.appendChild(a)),k(e),cjgApis.cache.setItem(i.account,"bm_cache_v30__classroom__querycourse",e))}function L(e,t){return cjBasics.ajax(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:cjBasics.urlParams.create(t)}).then(N).then(I)}function x(e){return L(cjBasics.urlParams.attach(t+"v7/querycourse",{rt:"j"}),{"f.req":"[[100,null,1,0],[true,true,null,null,true,true,true,true,[null,true,true,true,null,true,[true,true],null,[true],true,true,true,true],true,true,null,null,true,null,null,null,true,null,null,[true,true,true],true,true,null,true,null,null,null,[true,true],true,true,true,true,true,true,true,true,null,true,true,[null,null,true,null,true,true,true,true,true],null,[true,true,true],[true,true],true,true],[[null,[[true]],[]],[],[],[1,2,3],true,[],[1,2]]]",token:e})}function q(){return cjBasics.ajax(t).then(function(e){return e.match(/\\"([a-zA-Z0-9-_]{32,36}:\d{12,14})\\"/)[1]}).then(x)}function A(e){var t=!1;function a(){t||(t=!0,c.cjceSendFrameCommand({method:"classroomwithhybridUpdateState",value:e},_),y||W())}S.then(a),setTimeout(a,5e3)}var D={add:"M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z",filter:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z",settings:"M13.85 22.25h-3.7c-.74 0-1.36-.54-1.45-1.27l-.27-1.89c-.27-.14-.53-.29-.79-.46l-1.8.72c-.7.26-1.47-.03-1.81-.65L2.2 15.53c-.35-.66-.2-1.44.36-1.88l1.53-1.19c-.01-.15-.02-.3-.02-.46 0-.15.01-.31.02-.46l-1.52-1.19c-.59-.45-.74-1.26-.37-1.88l1.85-3.19c.34-.62 1.11-.9 1.79-.63l1.81.73c.26-.17.52-.32.78-.46l.27-1.91c.09-.7.71-1.25 1.44-1.25h3.7c.74 0 1.36.54 1.45 1.27l.27 1.89c.27.14.53.29.79.46l1.8-.72c.71-.26 1.48.03 1.82.65l1.84 3.18c.36.66.2 1.44-.36 1.88l-1.52 1.19c.01.15.02.3.02.46s-.01.31-.02.46l1.52 1.19c.56.45.72 1.23.37 1.86l-1.86 3.22c-.34.62-1.11.9-1.8.63l-1.8-.72c-.26.17-.52.32-.78.46l-.27 1.91c-.1.68-.72 1.22-1.46 1.22zm-3.23-2h2.76l.37-2.55.53-.22c.44-.18.88-.44 1.34-.78l.45-.34 2.38.96 1.38-2.4-2.03-1.58.07-.56c.03-.26.06-.51.06-.78s-.03-.53-.06-.78l-.07-.56 2.03-1.58-1.39-2.4-2.39.96-.45-.35c-.42-.32-.87-.58-1.33-.77l-.52-.22-.37-2.55h-2.76l-.37 2.55-.53.21c-.44.19-.88.44-1.34.79l-.45.33-2.38-.95-1.39 2.39 2.03 1.58-.07.56a7 7 0 0 0-.06.79c0 .26.02.53.06.78l.07.56-2.03 1.58 1.38 2.4 2.39-.96.45.35c.43.33.86.58 1.33.77l.53.22.38 2.55z"};function P(e){var t='body > nav div[soy-server-key] div > div[role] path[d*="'+D[e]+'"]';c.cjceSendFrameCommand({method:"bmCstClickParentElement",value:{selector:t,depth:2}},_)}var z,O=cjBasics.uniqueId.generate(),U=cjBasics.urlParams.attach(t+w,{bm_cid:"classroomwithhybrid",bm_wiz:"1",bm_cst:"1",bm_iid:O,forcehl:"1",hl:cjBasics.lang.current});function W(){y||(y=!0,b.remove(),l.cjceSetLoading(!1))}function M(){var e=(s.cjceSelectedId=w)in E;l.cjceSetBackState(!e),r.hidden="h"!==w,u.hidden="calendar"!==w,h.hidden="calendar"!==w;var t=w.startsWith("c/")&&-1===B.indexOf("/a/");t&&(p||(p=cjce.createElement("cjmd-appbar",{secondary:!0}),m=cjce.createElement("cjmd-tabs",{items:{c:"Stream",w:"Classwork",r:"People"},onChange:function(e){A(w.replace("c",e))},onMetaClick:function(e){T(w.replace("c",e))},selectedId:"c"}),p.appendChild(m),l.appendChild(p)),m.cjceSelectedId=B[0]),d.hidden=!t,p&&(p.hidden=!t);var a=E[w],c=a&&a.color;l.style.setProperty("--accent-color",c||"")}function F(){return cjce.createElement("bm-iframe",{src:U,solid:"#fff",shadow:!0,onMessage:function(e){var t,a,c,n=e.bm_method,r=e.bm_value;"classroomwithhybridViewData"===n?(B=r.pathname,w="h/archived"===(c=B)?c:!c||"h"===c||c.startsWith("h/")?"h":"calendar"===c||c.startsWith("calendar/")?"calendar":"ta"===c||c.startsWith("ta/")?"ta":"a"===c||c.startsWith("a/")?"a":-1===c.indexOf("/a/")&&(c.startsWith("r/")||c.startsWith("w/")||c.startsWith("c/"))?"c/"+c.split("/")[1].split("/")[0]:c,M(),(a=(t=E[w])&&t.label)||(a=r.title.split(" -")[0].split(" â€“")[0])&&a!==v||(a=f),l.cjceSetPageLabel(a)):"classroomwithhybridLoadingState"===n&&(l.cjceSetLoading(r),r||y||W())}})}cjBasics.webRequest.handleIframeHeaders([_+"/*bm_iid="+O+"*"],{disableOgs:_,handleFirefoxInject:!0}),l=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,serviceIcon:"classroom",serviceLabel:v,pageLabel:f,bmApis:i,onBack:function(){c.cjceSendFrameCommand({method:"bmCstNavigateBack"},_)},onNewTab:function(){c.cjceGetCleanUrl(_).then(function(e){e?i.openTab(e):T("h")})}}),e.appendChild(l),g||(r=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:add",label:cjBasics.lang.i18n("cj_i18n_06579","Create or join a class"),onClick:function(){y||A("h"),P("add")}}),l.cjceAppendChild(r),(d=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_06580","Class settings"),onClick:function(){P("settings")}})).hidden=!0,l.cjceAppendChild(d),(u=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:today",label:cjBasics.lang.i18n("cj_i18n_01253","Today"),onClick:function(){A("calendar/this-week/course/all")}})).hidden=!0,l.cjceAppendChild(u),(h=cjce.createElement("cjmd-iconbutton",{iconName:"__mdi:filter_list",onClick:function(){P("filter")}})).hidden=!0,l.cjceAppendChild(h)),o=l.cjceDrawerEl,k(),c=F(),e.appendChild(c),(b=document.createElement("div")).classList.add("bm-p-classroomwithhybrid-dummy"),j=cjce.createElement("cjmd-container",{solid:!!g||"#fff",scrollable:!0,shadow:"thinOnScroll"}),b.appendChild(j),cjce.applyTemplate(j,"basic-anyclickhandler",{onClick:function(e){var t,a=document.activeElement,c=a&&a.dataset.id;c&&(t=c,(g||cjBasics.events.hasMeta(e)?T:A)(t))}}),e.appendChild(b),cjgApis.cache.getItem(i.account,"bm_cache_v30__classroom__querycourse").then(function(e){!C&&Array.isArray(e)&&I(e)}),g||(z=["https://classroom.google.com/u/"+i.account.authuser+"/v*/querycourse?*"],"0"===i.account.authuser&&z.push("https://classroom.google.com/v*/querycourse?*"),cjBasics.webRequest.addListener("onBeforeRequest",function(e){var t;"POST"===e.method&&e.initiator.startsWith(_)&&(a(),t=e.requestBody.formData,JSON.stringify(t).match(/[["\d{11,13}"]]/)||L(e.url,t))},{urls:z,types:["xmlhttprequest"]},["requestBody"])),q().then(function(){g&&l.cjceSetLoading(!1)})});